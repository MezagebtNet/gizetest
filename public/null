$slug = 'addmes';


$gize_channel = $this->find_by_slug($slug);

        $activevideos = $this->getActiveChannelVideos($slug);

        $activerentals = ChannelvideoRentalController::getChannelActiveRentalsByUser($slug, \Auth::user()->id);

        $archives = $this->getChannelArchive($slug);

        $events = $this->loadSchedule($slug);

return $activevideos;
        return view('website.channel.landing', compact(['gize_channel', 'activevideos', 'activerentals', 'events', 'archives']));
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = \Auth::user()->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('ends_at', '>=', now())
                ->whereDate('starts_at', '<=', now())->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }
                return $channelvideos;

return $activevideos;
        return view('website.channel.landing', compact(['gize_channel', 'activevideos', 'activerentals', 'events', 'archives']));
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('ends_at', '>=', now())
                ->whereDate('starts_at', '<=', now())->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('ends_at', '>=', now())
                ->whereDate('starts_at', '<=', now())->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

returm now();
        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('ends_at', '>=', now())
                ->whereDate('starts_at', '<=', now())->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

return Date::now()
        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('ends_at', '>=', now())
                ->whereDate('starts_at', '<=', now())->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

return Date::now();
        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('ends_at', '>=', now())
                ->whereDate('starts_at', '<=', now())->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

return Date::now();
        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('ends_at', '>=', now())
                ->whereDate('starts_at', '<=', now())->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('America/New_York') );
return $now->format('Y-m-d H:i:s');
        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('ends_at', '>=', now())
                ->whereDate('starts_at', '<=', now())->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
return $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('ends_at', '>=', now())
                ->whereDate('starts_at', '<=', now())->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('ends_at', '>=', $now)
                ->whereDate('starts_at', '<=', $now)->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('ends_at', '>=', $now)
                ->whereDate('starts_at', '<=', $now)->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now;
        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now)
                ->whereDate('ends_at', '>=', $now)
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now)
                ->whereDate('ends_at', '>=', $now)
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 38)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->whereHas('video.id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->whereHas('video.id', 38)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

            $channelvideos = $channelvideos->merge($videos_in_batch);

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

		  	foreach($videos_in_batch->video as $vid){
				if($vid->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

		  	foreach($videos_in_batch->video as $vid){
				if($vid->id == 39) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

		  	foreach($videos_in_batch->video as $vid){
				if($vid->id == 39) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

		  	foreach($videos_in_batch->video as $vid){
				if($vid->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

		  	foreach($videos_in_batch->get()-video as $vid){
				if($vid->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

		  	foreach($videos_in_batch->video->get() as $vid){
				if($vid->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();

		  	foreach($videos_in_batch->value('video') as $vid){
				if($vid->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  return $videos_in_batch;

		  	foreach($videos_in_batch as $vid){
				if($vid->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  return $videos_in_batch->video;

		  	foreach($videos_in_batch as $vid){
				if($vid->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  return $videos_in_batch->first()->video;

		  	foreach($videos_in_batch as $vid){
				if($vid->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  return $videos_in_batch->first()->video->id;

		  	foreach($videos_in_batch as $vid){
				if($vid->first()->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  return $videos_in_batch->first()->video[0]->id;

		  	foreach($videos_in_batch as $vid){
				if($vid->first()->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  return $videos_in_batch->first()->video[0]->id;

		  	foreach($videos_in_batch as $vid){
				if($vid->first()->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  return $videos_in_batch->first()->video;

		  	foreach($videos_in_batch as $vid){
				if($vid->first()->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  return $videos_in_batch->first()->video->get();

		  	foreach($videos_in_batch as $vid){
				if($vid->first()->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  return $videos_in_batch->first()->video;

		  	foreach($videos_in_batch as $vid){
				if($vid->first()->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  return $videos_in_batch->first()->video->first();

		  	foreach($videos_in_batch as $vid){
				if($vid->first()->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  return $videos_in_batch->first()->video->first()->id;

		  	foreach($videos_in_batch as $vid){
				if($vid->first()->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $vid){
				if($vid->first()->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $vid){
				if($vid->first()->video->first()->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $vid){
				if($vid->first()->video->first()->id == 39) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $vid){
				if($vid->first()->video->first()->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $vid){
				if($vid->first()->video->first()->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $vid){
									$channelvideos = $channelvideos->merge($videos_in_batch);
				  
							}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  										$channelvideos = $channelvideos->merge($videos_in_batch);
				  
							
        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
				->where('id', 11)
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  										$channelvideos = $channelvideos->merge($videos_in_batch);
				  
							
        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  										$channelvideos = $channelvideos->merge($videos_in_batch);
				  
							
        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $vid){
				if($vid->first()->video->first()->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $vid){
				if($vid->first()->video->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->first()->video as $vid){
				if($vid->first()->video->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->first()->video as $vid){
				if($vid->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->first()->video as $vid){
				echo $vid->id;
				if($vid->id == 38) {
									  
				}
			  }
				
			}

        }

                
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $vid->id;
				if($vid->id == 38) {
									  
				}
			  }
				
			}

        }

                
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $vid->id;
				if($vid->id == 38) {
					$channelvideos = $channelvideos->merge($videos_in_batch);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $vid->id;
				if($vid->id == 38) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $vid->id;
				if($vid->id == 41) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $vid->id;
				if($vid->id == 42) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $vid->id;
				if($vid->id == 41) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $vid->id;
				if($vid->id != 42) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $vid->id;
				if($vid->id != 42) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $vid->id;
								  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
							  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $vid->id;
								  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
							  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $vid->id;
								  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
							  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $vid->id;
								  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
							  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
												  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
							  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->id == 42) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->id == 41) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->id == 38) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					
				  $channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos=$channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $vid->id;
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos=$channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->id;
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos=$channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->count();
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos=$channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->count().' '.$vid->id;
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos=$channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos=$channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
				  
				}
					$channelvideos=$channelvideos->merge($vid);
				
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

$vid_data = null;

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->count().' '.$vid->id.', ';
				$vid_data = $vid;
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
				  
				}
					$channelvideos=$channelvideos->merge($vid_data);
				
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

$vid_data = null;

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->count().' '.$vid->id.', ';
				$vid_data = $vid;
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
				  
				}
				if($vid_data != null)
				$channelvideos=$channelvideos->merge($vid_data);
				$vid_data = null
				
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

$vid_data = null;

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->count().' '.$vid->id.', ';
				$vid_data = $vid;
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
				  
				}
				if($vid_data != null)
				$channelvideos=$channelvideos->merge($vid_data);
				$vid_data = null;
				
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	return $vid;
					$channelvideos=$channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	return $vid->to_Array();
					$channelvideos=$channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	return $vid->toArray();
					$channelvideos=$channelvideos->merge($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  						$channelvideos=$channelvideos->merge($vid->toArray());
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  						$channelvideos=$channelvideos->merge(collect($vid->toArray()));
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  						$channelvideos=$channelvideos->merge(collect($vid));
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  				$vid = $videos->video->first();
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	return $vid->toArray();
					$channelvideos=$channelvideos->merge($vid->toArray());
				  
				}
			  				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  				$vid = $videos->video->first();
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  						$channelvideos=$channelvideos->merge($vid->toArray());
				  
				}
			  				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  				$vid = $videos->video->first();
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	return $vid->toArray();
					$channelvideos=$channelvideos->merge($vid->toArray());
				  
				}
			  				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  				$vid = $videos->video->first();
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  						$channelvideos=$channelvideos->merge($vid->toArray());
				  	return $channelvideos;
				  
				}
			  				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  				$vid = $videos->video->first();
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  					  echo $channelvideos;
					$channelvideos=$channelvideos->merge($vid->toArray());
				  	return $channelvideos;
				  
				}
			  				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  				$vid = $videos->video->first();
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  					  echo $channelvideos;
					$channelvideos=$channelvideos->merge($vid->toArray());
				  	echo $channelvideos;
				  
				}
			  				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  				$vid = $videos->video->first();
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  					  echo $channelvideos;
					$channelvideos=$channelvideos->merge($vid->toArray());
				  	echo $channelvideos.'\n';
				  
				}
			  				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  				$vid = $videos->video->first();
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  					  echo $channelvideos;
					$channelvideos=$channelvideos->merge($vid->toArray());
				  	echo $channelvideos.'**********************\n';
				  
				}
			  				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  				$vid = $videos->video->first();
				echo $videos->count().' '.$vid->id.', ';
				if(1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  					  echo $channelvideos;
					$channelvideos=$channelvideos->add($vid->toArray());
				  	echo $channelvideos.'**********************\n';
				  
				}
			  				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->id == 38) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->id == 41) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->id != 42) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  return $today;
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  return $today->format('Y-m-d H:i:s');
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  return  $today->format('Y-m-d H:i:s');
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  return  $today->format('Y-m-d H:i:s');
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  return  $today->format('Y-m-d H:i:s');
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  return  $today->format('Y-m-d H:i:s');
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  return  $today->format('Y-m-d H:i:s');
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  return  $today->format('Y-m-d H:i:s');
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  return  $today->format('Y-m-d H:i:s');
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  return  $today->format('Y-m-d H:i:s');
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<=', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>=', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  return  $today->format('Y-m-d H:i:s');
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  return  $today->format('Y-m-d H:i:s');
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		 		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		 		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  return  $today->format('Y-m-d H:i:s');
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
				  if($starts_at->lte($today))
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
				  if($starts_at->lte($today))
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
				  if(\Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at)->lte($today))
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at)->lte($today) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at)->gte($today)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-05 13:02:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at)->lte($today) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at)->gte($today)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-03 13:02:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at)->lte($today) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at)->gte($today)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:02:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at)->lte($today) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at)->gte($today)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:10:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at)->lte($today) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at)->gte($today)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:11:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at)->lte($today) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at)->gte($today)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:10:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at)->lte($today) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at)->gte($today)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:09:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at)->lte($today) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at)->gte($today)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                ->whereDate('starts_at', '<', $now->format('Y-m-d H:i:s'))
                ->whereDate('ends_at', '>', $now->format('Y-m-d H:i:s'))
			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:09:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, 'Africa/Addis_Ababa')->lte($today) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, 'Africa/Addis_Ababa')->gte($today)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                                			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:09:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, 'Africa/Addis_Ababa')->lte($today) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, 'Africa/Addis_Ababa')->gte($today)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);


        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone('Africa/Addis_Ababa') );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                                			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:10:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, 'Africa/Addis_Ababa')->lte($today) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, 'Africa/Addis_Ababa')->gte($today)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; 

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();

$now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                                			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:10:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($today) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($today)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                                			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:10:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($today) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($today)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                                			  ->get();
		  
		  $today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:10:00'); 
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');
$today = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:10:00'); 
		  
        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                                			  ->get();
		  
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');
$now = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:10:00'); 
		  
        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                                			  ->get();
		  
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');
		  
        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                                			  ->get();
		  
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');
		  
        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                                			  ->get();
		  
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');
		  
        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                                			  ->get();
		  
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');
		  
        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                                			  ->get();
		  
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');
		  
        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
                                			  ->get();
		  
		  		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');
$now = \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  '2021-10-02 13:10:00'); 
return  $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');
return  $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');
return  $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

               $vid_id = 41;
$validity = false;
        foreach ($activevideos as $vid) {
            if($vid->id == $vid_id){
                $validity = true;
            }
        }

        return $validity;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                return $channelvideos;
$vid_id = 41;
$validity = false;
        foreach ($activevideos as $vid) {
            if($vid->id == $vid_id){
                $validity = true;
            }
        }

        return $validity;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                $vid_id = 41;
$validity = false;
        foreach ($activevideos as $vid) {
		  	return $vid;
            if($vid->id == $vid_id){
                $validity = true;
            }
        }

        return $validity;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                $vid_id = 41;
$validity = false;
        foreach ($activevideos as $vid) {
		  	return $vid;
            if($vid->id == $vid_id){
                $validity = true;
            }
        }

        
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                $vid_id = 41;
$validity = false;
        foreach ($channelvideos as $vid) {
		  	return $vid;
            if($vid->id == $vid_id){
                $validity = true;
            }
        }

        
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                $vid_id = 41;
$validity = false;
        foreach ($channelvideos as $vid) {
		  	            if($vid->id == $vid_id){
                $validity = true;
            }
        }

        
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                $vid_id = 41;
$validity = false;
        foreach ($channelvideos as $vid) {
		  	            if($vid->id == $vid_id){
                $validity = true;
            }
        }

        return $validity;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                $vid_id = 42;
$validity = false;
        foreach ($channelvideos as $vid) {
		  	            if($vid->id == $vid_id){
                $validity = true;
            }
        }

        return $validity;
$slug = 'addmes';
$user = User::find(2);
$tz = 'Africa/Addis_Ababa'; $now = new DateTime("now", new DateTimeZone($tz) );
echo $now->format('Y-m-d H:i:s');

        $gize_channel = GizeChannel::where('slug', $slug)->firstOrFail();
                $user_id = $user->id;

        $user_batches = BatchUser::where('user_id', $user_id)
            ->where('active', 1)
            ->get()->pluck('batch_id');

        $active_batches = Batch::whereIn('id', $user_batches)->where('status', 1);
        
        $batches_in_channel = $active_batches->where('gize_channel_id', $gize_channel->id)->get();

        $channelvideos = collect([]);

        $videos = Channelvideo::where('active', 1)
            ->whereIn('video_available_for', [1, 2])
            ->get();



        foreach ($batches_in_channel as $batch) {

            $videos_in_batch = BatchChannelvideo::where('batch_id', $batch->id)
                ->whereIn('channelvideo_id', $videos->pluck('id'))
			  ->get();
		  
		  
		  	foreach($videos_in_batch as $videos){
			  foreach($videos->video as $vid){
								if($vid->active == 1) {
				  	$batch_channelvideo_id = $videos->id;
				    $starts_at = $videos->starts_at;
				    $ends_at = $videos->ends_at;
				    $batch_id = $videos->batch_id;
				  	$vid->starts_at = $starts_at;
				  	$vid->ends_at = $ends_at;
				  	$vid->batch_id = $batch_id;
					$vid->batch_channelvideo_id = $batch_channelvideo_id;
				  	
					if(
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $starts_at, $tz)->lte($now) &&
					  \Carbon\Carbon::createFromFormat('Y-m-d H:i:s',  $ends_at, $tz)->gte($now)
					)
					$channelvideos = $channelvideos->add($vid);
				  
				}
			  }
				
			}

        }

                $vid_id = 41;
$validity = false;
        foreach ($channelvideos as $vid) {
		  	            if($vid->id == $vid_id){
                $validity = true;
            }
        }

        return $validity;
